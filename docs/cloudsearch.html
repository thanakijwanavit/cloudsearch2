---

title: cloudsearch


keywords: fastai
sidebar: home_sidebar

summary: "a library to trigger aws cloudsearch endpoint"
description: "a library to trigger aws cloudsearch endpoint"
nb_path: "cloudsearch.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: cloudsearch.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Search" class="doc_header"><code>class</code> <code>Search</code><a href="https://github.com/thanakijwanavit/cloudsearch/tree/master/cloudsearch/cloudsearch.py#L11" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Search</code>(<strong><code>searchTerm</code></strong>:<code>str</code>, <strong><code>key</code></strong>=<em><code>None</code></em>, <strong><code>pw</code></strong>=<em><code>None</code></em>, <strong><code>region</code></strong>=<em><code>'ap-southeast-1'</code></em>, <strong><code>endpoint</code></strong>=<em><code>''</code></em>, <strong><code>requiredFields</code></strong>=<em><code>['villa_category_l1_en', 'villa_category_l2_en', 'villa_category_l3_en', 'villa_category_l4_en']</code></em>)</p>
</blockquote>
<p>a search class to return search result</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">searchEndpoint</span> <span class="o">=</span> <span class="s1">&#39;https://search-villa-cloudsearch-2-4izacsoytzqf6kztcyjhssy2ti.ap-southeast-1.cloudsearch.amazonaws.com&#39;</span>
<span class="n">searcher</span> <span class="o">=</span> <span class="n">Search</span><span class="p">(</span><span class="n">searchTerm</span> <span class="o">=</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">USER</span><span class="p">,</span> <span class="n">pw</span><span class="o">=</span> <span class="n">PW</span> <span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">searchEndpoint</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">searcher</span><span class="o">.</span><span class="n">sortedSearch</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>raw search result is     villa_category_l1_en villa_category_l2_en      villa_category_l3_en  \
0                  Fresh        Fresh Produce  Fruits &amp; Vegetable Local   
1                    NaN                  NaN                       NaN   
2                  Fresh        Fresh Produce                    Bakery   
3                  Fresh        Fresh Produce                    Bakery   
4                  Fresh        Fresh Produce                    Bakery   
..                   ...                  ...                       ...   
450                Fresh        Seafood Fresh                Crustacean   
451                Fresh        Seafood Fresh                Crustacean   
452                Fresh        Seafood Fresh                Crustacean   
453                Fresh               Frozen                   Seafood   
454                Fresh        Seafood Fresh             Local Seafood   

    villa_category_l4_en  
0            Local Fruit  
1                    NaN  
2          Cake category  
3          Cake category  
4         Pasty category  
..                   ...  
450                Local  
451                Local  
452                Local  
453                  NaN  
454                  NaN  

[455 rows x 4 columns]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>455</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">json</span>
<span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>549306</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">searcher</span><span class="o">.</span><span class="n">cloudSearch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;pork&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)[</span><span class="s1">&#39;hits&#39;</span><span class="p">][</span><span class="s1">&#39;hit&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>726</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="n">boostDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;fields&quot;</span><span class="p">:[</span><span class="s2">&quot;online_category_l1_en&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">queryOptions</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">boostDict</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">searcher</span><span class="o">.</span><span class="n">cloudSearch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;dairy&#39;</span><span class="p">,</span> <span class="n">queryOptions</span> <span class="o">=</span> <span class="n">queryOptions</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)[</span><span class="s1">&#39;hits&#39;</span><span class="p">][</span><span class="s1">&#39;hit&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">searcher2</span> <span class="o">=</span> <span class="n">Search</span><span class="p">(</span><span class="n">searchTerm</span> <span class="o">=</span> <span class="s1">&#39;dairy&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">USER</span><span class="p">,</span> <span class="n">pw</span><span class="o">=</span> <span class="n">PW</span> <span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">searchEndpoint</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">searcher2</span><span class="o">.</span><span class="n">sortedSearch</span><span class="p">(</span><span class="n">queryOptions</span> <span class="o">=</span> <span class="n">queryOptions</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>raw search result is   villa_category_l1_en villa_category_l2_en villa_category_l3_en  \
0                Fresh                Dairy               Cheese   
1                Fresh                Dairy     Butter/Margarine   
2                Fresh                Dairy                 Milk   
3                Fresh                Dairy                 Milk   
4                Fresh                Dairy                 Milk   
5                Fresh                Dairy                 Milk   
6                Fresh                Dairy               Cheese   
7                Fresh                Dairy                 Milk   
8                Fresh                Dairy                 Milk   
9                Fresh                Dairy                 Milk   

   villa_category_l4_en  
0                   NaN  
1                   NaN  
2                   NaN  
3                   NaN  
4                   NaN  
5                   NaN  
6                   NaN  
7                   NaN  
8                   NaN  
9                   NaN  
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

